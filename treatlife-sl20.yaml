# Device Name
substitutions:
  name: treatlife-sl20
  friendly_name: Porch Light

esphome:
  name: ${name}
  name_add_mac_suffix: true

# Device SoC
bk72xx:
  board: generic-bk7231t-qfn32-tuya
  framework:
    version: latest

# Wi-Fi & AP Setup
wifi:
  ssid: !secret wifi_ssid
  password: !secret wifi_password
  manual_ip:
    static_ip: 172.16.184.242
    gateway: !secret gateway
    subnet: 255.255.255.0
    dns1: !secret gateway
  ap:
    ssid: ${name}
    password: !secret wifi_password

captive_portal:
web_server:
  port: 80

# Enable Logging
logger:

# Enable Home Assistant API & OTA
api:
  encryption:
    key: !secret ha_key
ota:
  password: !secret ota_password

# Reports Wi-Fi Strength in db
sensor:
- platform: wifi_signal
  name: Signal Strength
  update_interval: 60s

# Reports Device Uptime
- platform: uptime
  name: Device Uptime
  filters:
    - lambda: return x / 60.0;
  unit_of_measurement: minutes

# Restart Switch
switch:
  - platform: restart
    name: Reboot

# Output Pins
output:
- platform: libretiny_pwm
  id: cold_white
  pin: D4
  inverted: False
  max_power: 70%
- platform: libretiny_pwm
  id: warm_white
  pin: D5
  inverted: False
  max_power: 70%

# Light Devices
light:  
- platform: cwww
  name: ${friendly_name}
  cold_white: cold_white
  warm_white: warm_white
  cold_white_color_temperature: 6500 K
  warm_white_color_temperature: 2700 K
  constant_brightness: true
  id: thelight
  restore_mode: ALWAYS_ON

# Set Default Color on Boot
  on_turn_on:
    - light.turn_on:
        id: thelight
        brightness: 70%
        cold_white: 0%
        warm_white: 100%
